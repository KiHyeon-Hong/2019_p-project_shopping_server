<!doctype html>
<html class="no-js" lang="zxx">

<% include inc-head %>

<%
var str_section = ["봄","여름","가을","겨울"] // 대분류 명
%>

<body>
	<!--[if lte IE 9]>
		<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
	<![endif]-->

	<!-- Main wrapper -->
	<div class="wrapper" id="wrapper">

		<% include inc-header %>

		<!-- Start Bradcaump area -->
		<div class="ht__bradcaump__area bg-image--4">
			<div class="container">
				<div class="row">
					<div class="col-lg-12">
						<div class="bradcaump__inner text-center">
							<h2 class="bradcaump-title"><i class="fas fa-plus-circle fa-2x"></i></h2>
							<nav class="bradcaump-content">
								<span class="brd-separetor">상품 등록</span>
							</nav>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- End Bradcaump area -->

		<!-- Start main Content -->
		<div class="maincontent bg--white pt--80 pb--55">
			<div class="container chswhite mb-5 " style="min-height: 1000px;">
				<div class="row">
					<div class="col-lg-12 col-12">
						<form id="findpw" name="editform" method="post" enctype="multipart/form-data">
							<div class="wn__single__product">
								<div class="row">
									
					<style>
						div.product__info__main  input{
							padding: .375rem .75rem;
						}
					</style>
									<div class="col-lg-6 col-12">
										<div class="mb-3">
											<h2>새 상품 등록하기</h2>
											<p>상품을 등록하기 앞서 썸네일 이미지를 등록해주세요.


												<br>
												AI 기반의 이미지 분류 모델을 통한 이미지 등록이 승인 된 후에 <br>나머지 자세한 정보를 입력할 수 있습니다.

											</p>

										</div>
										<img id="img1" src="/images/image_upload.png" width="100%"/>
										<hr>
										<input id="input_img" type="file" name="main" style="display:none" />

									</div>
									<div class="col-lg-6 col-12" id="leftform" style="display: none;">
										<div class="product__info__main">
											<input type=text name=productName value="" placeholder="productName" /><br>

											<div class="price-box">
												<input type="number" name=productPrice value="1000">원
											</div>
											<div class="product__overview">
												<!-- <p style="border-style: ridge;">product info. </p> -->
												<textarea style="width:100%" rows="15" name="productText"
													placeholder="info"> </textarea>
											</div>
											<!-- <div class="box-tocart d-flex">
														<span>Qty</span>
														<input id="qty" class="input-text qty" name="qty" min="1" value="999" title="Qty" type="number">

													</div> -->

											<div class="dropdown mb-3">

												<a class="btn btn-secondary dropdown-toggle" role="button"
													id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true"
													aria-expanded="false" style=" color: white; ">
													분류
												</a>

												<div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
													<%
																for(var i=0;i<str_section.length;i++){
																%>
													<a class="dropdown-item"
														href="javascript:selectCa('<%=str_section[i]%>');"><%=str_section[i]%></a>
													<%}%>
															</div>
															</div>
															<script>
																function selectCa(data) {
																	document.editform.productCategory.value = data;
																	dropdownMenuLink.innerHTML = data;
																	console.log(document.editform.productCategory.value)
																}
															</script>
															<input type="hidden" name="productCategory" value="과일" />


													<div class="product_meta">

													<!-- <span class="posted_in">Keyword:
															<a  style="border-style: ridge;"href="#">food</a>,
															<a style="border-style: ridge;" href="#">Fruit</a>
														</span> -->
														</div>
												</div>
											</div>
										</div>
									</div>
									<div class="product__info__detailed" id="leftform" style="display: none;">
										<div class="pro_details_nav nav justify-content-start" role="tablist">
											<a class="nav-item nav-link active" data-toggle="tab" href="#nav-details" role="tab">상세 정보</a>
										</div>
										<div class="tab__container">
											<!-- Start Single Tab Content -->
											<div class="pro__tab_label tab-pane fade show active" id="nav-details" role="tabpanel" style=" text-align: center; ">

												<!-- main / detail_0 / detail_1/ detail_2/ detail_3 -->
												<img id="img2" src="/images/image_upload.png"width="70%"/>
												<hr>
												<input type="file"  id="input_img2"  name="detail_0" style="display:none"/><br>

												<img id="img3" src="/images/image_upload.png"width="70%"/>
												<hr>
												<input type="file"  id="input_img3"  name="detail_1" style="display:none"/><br>

												<img id="img4" src="/images/image_upload.png"width="70%"/>
												<hr>
												<input type="file"  id="input_img4"  name="detail_2" style="display:none"/><br>

												<img id="img5" src="/images/image_upload.png"width="70%"/>
												<hr>
												<input type="file"  id="input_img5"  name="detail_3" style="display:none"/><br>
													<script type="text/javascript">

														var sel_file;

														$(document).ready(function () {
															$('#img1').click(function (e) {
																e.preventDefault();
																$('#input_img').click();
															});
															$('#img2').click(function (e) {
																e.preventDefault();
																$('#input_img2').click();
															});
															$('#img3').click(function (e) {
																e.preventDefault();
																$('#input_img3').click();
															});
															$('#img4').click(function (e) {
																e.preventDefault();
																$('#input_img4').click();
															});
															$('#img5').click(function (e) {
																e.preventDefault();
																$('#input_img5').click();
															});

															$("#input_img").on("change", handleImgFileSelect);
															$("#input_img2").on("change", handleImgFileSelect2);
															$("#input_img3").on("change", handleImgFileSelect2);
															$("#input_img4").on("change", handleImgFileSelect2);
															$("#input_img5").on("change", handleImgFileSelect2);
														});


														function handleImgFileSelect(e) {
															var files = e.target.files;
															var filesArr = Array.prototype.slice.call(files);

															filesArr.forEach(function (f) {
																if (!f.type.match("image.*")) {
																	alert("확장자는 이미지 확장자만 가능합니다.");
																	return;
																}

																sel_file = f;

																var reader = new FileReader();
																reader.onload = function (e) {
																	$("#img1").attr("src", e.target.result);
																}
																reader.readAsDataURL(f);

																upload()

															});

														}
														function handleImgFileSelect2(e) {
															
															var num = e.target.id.toString().substr(9,1)
															console.log(num)
															var files = e.target.files;
															var filesArr = Array.prototype.slice.call(files);

															filesArr.forEach(function (f) {
																if (!f.type.match("image.*")) {
																	alert("확장자는 이미지 확장자만 가능합니다.");
																	return;
																}

																sel_file = f;

																var reader = new FileReader();
																reader.onload = function (e) {
																	$("#img"+num).attr("src", e.target.result);
																}
																reader.readAsDataURL(f);
															});
														}
													</script>


											</div>
										</div>
										<div class="form__btn mt-5">
											<button type="button" onclick="javascript:document.editform.submit();" 
											style=" background-color: #e59285; border-color: #e59285; background: #e59285 none repeat scroll 0 0; border: 0 none; color: #fff; font-size: 14px; font-weight: 600; height: 40px; line-height: 40px; padding: 0 25px; text-transform: uppercase; "
											>등록</button>
									</div>
									</div>
									
								</form>
								</div>
								<div class="col-lg-3 col-12 md-mt-40 sm-mt-40">
								

							</div>

        		</div>
        	</div>
		
		

			
			<button  class="btn btn-default tocart" data-target="#layerpop" data-toggle="modal"  type="button" style="display: none;"
			>Add to Cart</button>

			<!-- 모달 -->
			<div class="modal fade" id="layerpop" >
					<div class="modal-dialog">
					  <div class="modal-content" style="
					  background-color: rgba(255,255,255,0.95);
				  ">
						<!-- header -->
						<div class="modal-header">
							<h4 id="modaltitle">hi</h4>
						  <!-- 닫기(x) 버튼 -->
						  <button type="button" class="close" data-dismiss="modal">×</button>
						  <!-- header title -->
						  <h4 class="modal-title"></h4>
						</div>
						<!-- body -->
						<div class="modal-body result" >
							 <img src="/images/loading img.gif">
							 <br>
							 <p>승인 대기...</p>
						</div>
						<!-- Footer -->
						<div class="modal-footer" style="display: none;">
						  <button style=" width: 100px; "type="button" class="btn btn-primary" 
						  onclick = "location.href = '/src/buyer/search/image/result' " >네</button>
						  <button style=" width: 100px; "type="button" class="btn btn-default" 
						  onclick = "location.href = '/src/buyer/search/image/retry' "data-dismiss="modal">아니오</button>
						</div>
					  </div>
					</div>
				  </div>
		
		</div>
		<!-- End main Content -->



		<% include inc-footer %>

												</div>
												<!-- //Main wrapper -->


												<script>
													function upload() {

														// 에이젝스로 이미지 전송하기.
														test('/src/productManagement/imageFiltering', $('#findpw')[0]);

													}
												</script>

												<script>

													function test(url, form) {
														var formData = new FormData(form);
														onloading();

														$.ajax({
															url: url,
															processData: false,
															contentType: false,
															data: formData,
															type: 'POST',
															success: function (result) {
																alert(result.resultv);
																switch (result.result) {
																	case 'ok':
																		offloading(result.resultv);
																		leftform[0].style.display = ''
																		leftform[1].style.display = ''
																		break;
																	case 'bad':
																		offloading(result.resultv);
																		location.reload()

																	default:
																}
															}
														});

													}


													function onloading() {
														$('.tocart').click();
														$('.result')[0].innerHTML = "<img src='/images/loading img.gif'><br><p>승인 대기...</p>";
														$('.modal-footer')[0].style.display = 'none'
														modaltitle.innerHTML = "승인 대기..."

													}

													function offloading(msg) {

														// $('.result')[0].innerHTML='결과 : '+msg;
														// modaltitle.innerHTML = msg

														// $('.modal-footer')[0].style.display = ''

														$('.close').click();
													}
												</script>

												<% include inc-script %>

</body>

</html>